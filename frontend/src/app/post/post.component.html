<div>
    
    <div *ngFor="let post of posts" class="d-flex flex-column mt-4 mb-4">
    
        <div class="card">
            <div class="card-header p-3">
                <div class="d-flex flex-row align-items-center">
                    <div
                        class="rounded-circle overflow-hidden d-flex justify-content-center align-items-center border border-danger post-profile-photo mr-3">
                        <img src="assets/images/profiles/profile-1.jpg" alt="..."
                            style="transform: scale(1.5); width: 100%; position: absolute; left: 0;">
                    </div>
                    <span class="font-weight-bold px-2">{{post.username}} <span *ngIf="post.verified" style="color: Dodgerblue;"> <i class="fa-solid fa-circle-check"></i> </span></span>
<span class="text-muted"> &middot; </span>
<span class="text-muted">3 days</span>
                </div>
            </div>
            <div class="card-body p-0">
              <ng-container *ngIf="post.images.length > 1; else singleMedia">
                <!-- Carousel for multiple images -->
                <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                  <ol class="carousel-indicators">
                      <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                      <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                      <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                  </ol>
                  <div class="carousel-inner">
                      <div  class="carousel-item active">
                          <img class="d-block w-100" src="https://png.pngtree.com/background/20230613/original/pngtree-four-beautiful-african-women-picture-image_3386578.jpg" alt="First slide">
                          <!-- <div class="carousel-caption d-none d-md-block">
                              <h5>My Caption Title (1st Image)</h5>
                              <p>The whole caption will only show up if the screen is at least medium size.</p>
                          </div> -->
                      </div>
                      <div class="carousel-item">
                          <img class="d-block w-100" src="https://guardian.ng/wp-content/uploads/2021/06/Wodaabe-Tribe.-Photo-Liba-Taylor-Alamy-Stock-Photo-e1624874795586.jpeg" alt="Second slide">
                      </div>
                      <div class="carousel-item">
                          <img class="d-block w-100" src="https://www.ucf.edu/wp-content/blogs.dir/4/files/2020/10/FA2020-WhyI-1600x900.jpg" alt="Third slide">
                      </div>
                  </div>
                  <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                      <span class="sr-only">Previous</span>
                  </a>
                  <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                      <span class="sr-only">Next</span>
                  </a>
              </div>
              </ng-container>
              <ng-template #singleMedia>
                <ng-container *ngIf="post.images.length === 1">
                  <!-- Check if the first item in post.images is a video -->
                  <ng-container *ngIf="isVideo(post.images[0])">
                    <vg-player>
                      <video [vgMedia]="$any(media)" #media id="singleVideo" preload="auto" controls>
                        <source [src]="post.images[0]" type="video/mp4">
                      </video>
                    </vg-player>
                  </ng-container>
                  <!-- If it's not a video, assume it's an image -->
                  <ng-container *ngIf="!isVideo(post.images[0]) && post.images.length > 0">
                    <img [src]="post.images[0]" alt="Post Media" class="d-block w-100">
                  </ng-container>
                </ng-container>
              </ng-template>
    
                <div class="d-flex flex-row justify-content-between pl-3 pr-3 pt-3 pb-1">
                    <ul class="list-inline d-flex flex-row align-items-center m-0">
                        <li class="list-inline-item">
                            <button class="btn p-0" (click)="toggleLike(post)">
                              <span *ngIf="post.isLiked">
                                <i class="fa-solid fa-heart"  style="color: red;"></i>
                          
                              </span>
                              <span *ngIf="!post.isLiked">
                                <i class="fa-regular fa-heart"></i>
                              </span>
                              
                            </button>
                        </li>
                        <li class="list-inline-item ml-2">
                            <button class="btn p-0"  data-bs-toggle="modal" [attr.data-bs-target]="'#post_' + post.id">
                              <i class="fa-regular fa-comment"></i>
                            </button>
                        </li>
                        <li class="list-inline-item ml-2">
                            <button class="btn p-0" data-bs-toggle="modal" data-bs-target="#share">
                              <i class="fa-regular fa-paper-plane"></i>
                            
                            </button>
                        </li>
                    </ul>
                    <div>
                        <button class="btn p-0 m-2" (click)="toggleBookmark(post)">
                          <span *ngIf="post.isBookmarked">
                            <i class="fa-solid fa-bookmark" style="color: black;"></i>
                          </span>

                          <span *ngIf="!post.isBookmarked">
                          <i class="fa-regular fa-bookmark"></i>                        
                        </span>
                        </button>
                    </div>
                </div>
    
                <div class="pl-3 pr-3 pb-2">
                   <small> <strong class="d-block">{{ post.likes }} likes</strong></small>
                  
                    <small class="d-block mb-1">{{ post.description }}</small>
              
                        <span class="text-muted" data-bs-toggle="modal" style="cursor: pointer;" data-bs-target="#comments">View all {{post.comments.length}} comments</span>
                   
    
                   
    
                  
                </div>
    
                <div class="position-relative comment-box">
                    <form>
                        <input class="w-100 border-0 p-3 input-post" placeholder="Add a comment..." 
                        type="text"
                        name="textarea2"
                        [(ngModel)]="textArea2">
                        <button (click)="postComment(post)" class="btn btn-primary position-absolute btn-ig">Post</button>
                    </form>
                </div>
    
    
            </div>
        </div>
    
    </div>

  
  
</div>


<div *ngFor="let post of posts">
    <div class="modal fade" [id]="'post_' + post.id">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
  
          <!-- Modal Header -->
          <div class="modal-header text-center">
            <div class="d-flex flex-column align-items-center">
                <div class="rounded-circle overflow-hidden d-flex justify-content-center align-items-center border border-danger story-profile-photo">
                  <img [src]="post.profileImage" alt="Profile" style="transform: scale(1.5); width: 100%; position: absolute; left: 0;">
                </div>
                <small>{{ post.username }}</small>
              </div>
              
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
  
          <!-- Modal body -->
          <div class="modal-body p-2">
 <div class="w-100">
  <ng-container *ngIf="post.images.length > 1; else singleMedia">
                <!-- Carousel for multiple images -->
                <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                  <ol class="carousel-indicators">
                      <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                      <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                      <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                  </ol>
                  <div class="carousel-inner">
                      <div  class="carousel-item active">
                          <img class="d-block w-100" src="https://png.pngtree.com/background/20230613/original/pngtree-four-beautiful-african-women-picture-image_3386578.jpg" alt="First slide">
                          <!-- <div class="carousel-caption d-none d-md-block">
                              <h5>My Caption Title (1st Image)</h5>
                              <p>The whole caption will only show up if the screen is at least medium size.</p>
                          </div> -->
                      </div>
                      <div class="carousel-item">
                          <img class="d-block w-100" src="https://guardian.ng/wp-content/uploads/2021/06/Wodaabe-Tribe.-Photo-Liba-Taylor-Alamy-Stock-Photo-e1624874795586.jpeg" alt="Second slide">
                      </div>
                      <div class="carousel-item">
                          <img class="d-block w-100" src="https://www.ucf.edu/wp-content/blogs.dir/4/files/2020/10/FA2020-WhyI-1600x900.jpg" alt="Third slide">
                      </div>
                  </div>
                  <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                      <span class="sr-only">Previous</span>
                  </a>
                  <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                      <span class="sr-only">Next</span>
                  </a>
              </div>
              </ng-container>
              <ng-template #singleMedia>
                <ng-container *ngIf="post.images.length === 1">
                  <!-- Check if the first item in post.images is a video -->
                  <ng-container *ngIf="isVideo(post.images[0])">
                    <vg-player>
                      <video [vgMedia]="$any(media)" #media id="singleVideo" preload="auto" controls>
                        <source [src]="post.images[0]" type="video/mp4">
                      </video>
                    </vg-player>
                  </ng-container>
                  <!-- If it's not a video, assume it's an image -->
                  <ng-container *ngIf="!isVideo(post.images[0])">
                    <img [src]="post.images[0]" alt="Post Media" class="d-block w-100">
                  </ng-container>
                </ng-container>
              </ng-template>     
    </div>
          
            <!-- Comments on the right -->
            <div class="w-100 position-relative">
            
              
                <!-- Content container for comments and other elements -->
                <div class="ml-auto">
                  <!-- List of comments (scrollable) -->
                  <div class="comments-container overflow-auto" style="max-height: 400px;">
                    <div>
                      <section class="gradient-custom">
                       
                          <div class="row d-flex justify-content-center">
                            <div class="col-12">
                              <div class="card">
                                <div class="card-body p-4">
                                  
                      
                                  <div class="row" *ngFor="let entry of discussionData">
                                    <!-- Entry -->
                                    <div class="col">
                                      <div class="d-flex flex-start">
                                        <img class="rounded-circle shadow-1-strong me-3" [src]="entry.avatar" alt="avatar" width="65" height="65" />
                                        <div class="flex-grow-1 flex-shrink-1">
                                          <div>
                                            <div class="d-flex justify-content-between align-items-center">
                                              <p class="mb-1">
                                                {{ entry.author }} <span class="small">- {{ entry.time }}</span>
                                              </p>

                                             <a *ngIf="entry.replies.length <= 2" style="cursor: pointer;text-decoration: none;"  class="text-primary"   (click)="replyToComment(entry)">
                                                <i class="fas fa-reply fa-xs"></i><span class="small"> reply</span>
                                              </a>

                                              
                                              </div>
  
                                              <p class="small mb-0">
                                              {{ entry.content }} <a class="text-warning mx-2" (click)="editextArea(entry.content)"><i class="fa-solid fa-pen-to-square"></i> Edit</a>

                                              <a class="text-danger mx-2" (click)="deleteEntry(entry)">
                                                <i class="fa-solid fa-pen-to-square"></i> Delete
                                              </a>                                            </p>
                                          </div>
                          
                                          <!-- Replies -->
                                          <div class="d-flex flex-start mt-4" *ngFor="let reply of entry.replies">
                                            <a class="me-3" href="#">
                                              <img class="rounded-circle shadow-1-strong" [src]="reply.avatar" alt="avatar" width="65" height="65" />
                                            </a>
                                            <div class="flex-grow-1 flex-shrink-1">
                                              <div>
                                                <div class="d-flex justify-content-between align-items-center">
                                                  <p class="mb-1">
                                                    {{ reply.author }} <span class="small">- {{ reply.time }}</span>
                                                  </p>
                                                </div>
                                                <p class="small mb-0">
                                                 @{{ entry.author }} {{ reply.content }}
                                                </p>
                                              </div>
                                            </div>
                                          </div>
                                          <!-- End Replies -->
                                        </div>
                                      </div>
                                    </div>
                                    <hr/>
                                    <!-- End Entry -->
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                       
                      </section>

                     
                          
                     
                      </div>
                  </div>
              
                             
                  <!-- Number of likes -->
                
              
                  <!-- Input with emoji button selector -->
                  <div class="input-group mt-3">
                    <input 
                    
                    type="text"
                    class="form-control"
                    name="textarea"
                    [(ngModel)]="textArea"
                    placeholder="Add a comment..."
                    >
                    <div class="input-group-append">
                      <button data-toggle="collapse" class="btn btn-outline-secondary" data-bs-toggle="collapse" data-bs-target="#emoji" aria-expanded="false"  type="button">😀</button>
                    </div>
                  </div>
                  <div id="emoji" class="collapse">
                    <div class="row">
                      <div class="col-12">
                        <emoji-mart
                        class="emoji-mart w-100"
                        
                        (emojiSelect)="addEmoji($event)"
                        title="Choose your emoji"
                      ></emoji-mart>
                      </div>
                    </div>
                   
                </div>
                </div>
              </div>          </div>
  
        </div>
      </div>
    </div>
  </div>




  <div class="modal fade" id="share">
    <div class="modal-dialog">
        <div class="modal-content">
    
          <!-- Modal Header -->
          <div class="modal-header text-center">
            <h4 class="modal-title">Share</h4>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
    
          <!-- Modal body -->
          <div class="modal-body p-2">
            <!-- "To:" label and input -->
            <div class="form-group d-flex align-items-center">
                <label for="recipientInput" class="mr-2">To:</label>
                <input type="text" class="form-control border-0" id="recipientInput" [(ngModel)]="searchQuery" placeholder="Search users..." (input)="searchUsers()">
              </div>
          
            <!-- List of users with profile pics, names, and usernames -->
            <div class="list-group">
              <div *ngFor="let user of searchResults" class="d-flex flex-row justify-content-between align-items-center mt-3 mb-3">
                <div class="d-flex flex-row align-items-center">
                  <div class="rounded-circle overflow-hidden d-flex justify-content-center align-items-center border sugest-profile-photo">
                    <img src="{{ user.profileImage }}" alt="..." style="transform: scale(1.5); width: 100%; position: absolute; left: 0;">
                  </div>
                  <strong class="ml-3 sugest-username">{{ user.username }}</strong>
                </div>
              </div>
              

             
        
      </div>
          </div>
          
    
        
    
        </div>
      </div>
  </div>